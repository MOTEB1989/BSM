# ูุฑุงุฌุนุฉ ููุทููุฉ ููููุฏ ุงูุณุญุงุจู ุงูููุชุฑุญ

## ููุฎุต ุณุฑูุน
ุชูุช ูุฑุงุฌุนุฉ ุงูููุงุทุน ุงูููุชุฑุญุฉ (GitHub Actions + Render + setup scripts + server + dashboard) ูุน ุงูุชุฑููุฒ ุนูู ุงูุชูุฑุงุฑุ ุงูุฃุฎุทุงุก ุงูููุทููุฉุ ุงูุฃููุ ููุงุจููุฉ ุงูุชูุณุน.

## 1) ุชูุฑุงุฑ ูุณุจุจ ุชุถุงุฑุจุงู ูู ุงููุตุฏุฑ (Single Source of Truth)

### ุงููุดููุฉ
ุชุนุฑูู ุงููููุงุก ููุฑุฑ ูู ุฃูุซุฑ ูู ููุงู:
- `setup-agents` ุฏุงุฎู workflow
- `scripts/setup.sh`
- ูููุงุช YAML ููุชุฑุถุฉ ุฏุงุฎู `data/agents/*`

ูุฐุง ูุฎูู drift ูุน ุงูููุช (ูุณุฎุฉ ุชุชุญุฏุซ ูุฃุฎุฑู ุชูุณู).

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ุงุนุชูุงุฏ ูุตุฏุฑ ูุงุญุฏ ููุท ูุชุนุฑูู ุงููููุงุก: `data/agents/*.yaml`.
- ุฃู ุณูุฑุจุช ุฅูุดุงุก ูุฌุจ ุฃู ูููู idempotent ููุนูู ููุท ููุชููุฆุฉ ุงูุฃูููุ ูููุณ ุถูู ูู ูุดุฑ.

### ูุซุงู ูุฎุชุตุฑ
ุจุฏูุงู ูู ุฅูุดุงุก YAML ุฏุงุฎู workflowุ ุงุณุชุฏุนู ุณูุฑุจุช ูุงุญุฏ:
```bash
./scripts/setup.sh --bootstrap-only
```
ุซู ุงุฌุนู workflow ููุชูู ุจุงูุชุญูู:
```bash
npm run validate
```

---

## 2) ุฎุทุฃ ููุทูู ูู payload ุฅุดุนุงุฑ Nexus

### ุงููุดููุฉ
ุฏุงุฎู ุฎุทูุฉ `Notify Nexus` ูู workflowุ JSON ููุชูุจ ุถูู single quotes:
```bash
-d '{"event": "deploy", "status": "success", "commit": "${{ github.sha }}"}'
```
ุจูุฐุง ุงูุดูู ูููุฉ commit ูุฏ ูุง ุชูุณุชุจุฏู ููุง ูู ูุชููุน ูุฃู ุงูุตูุงุบุฉ ูุฎุชูุทุฉ ุจูู ุชุนุงุจูุฑ GitHub ูshell quoting.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ูููู JSON ุนุจุฑ `jq -n` ูุชูุงุฏู ูุดุงูู escaping.

### ูุซุงู ูุฎุชุตุฑ
```bash
payload=$(jq -n --arg sha "${GITHUB_SHA}" '{event:"deploy",status:"success",commit:$sha}')
curl -X POST "$NEXUS_WEBHOOK" -H "Content-Type: application/json" -d "$payload"
```

---

## 3) ุงุฎุชุจุงุฑ ุงููููุงุก ูู CI ุบูุฑ ุญุชูู (Flaky)

### ุงููุดููุฉ
ุงุฎุชุจุงุฑุงุช CI ุชุณุชุฏุนู ูุฒูุฏุงุช ุฎุงุฑุฌูุฉ ูุจุงุดุฑุฉ (Perplexity/OpenAI/Anthropic). ูุฐุง ูุณุจุจ:
- ูุดู ุนุดูุงุฆู ุจุณุจุจ ุงูุดุจูุฉ/limits.
- ุจุทุก ุดุฏูุฏ ููุชุงุฆุฌ ุบูุฑ ูุณุชูุฑุฉ.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ูุตู ุงูุงุฎุชุจุงุฑุงุช ุฅูู ูุณุชูููู:
  - smoke/unit ุจุฏูู ุงุชุตุงู ุฎุงุฑุฌู (ุงูุชุฑุงุถู ูู ูู PR)
  - integration gated ูุดุชุบู ูุฏููุงู ุฃู ุจูุณู ูุนูู.

---

## 4) route ุงูู Webhook ุจุฏูู ุชุญูู ุชูููุน GitHub

### ุงููุดููุฉ
`/webhook/github` ููุจู ุทูุจุงุช ุจุฏูู ุงูุชุญูู ูู `X-Hub-Signature-256`.

### ุงููุฎุงุทุฑ
- ุฃู ุทุฑู ุฎุงุฑุฌู ููุฏุฑ ูุฑุณู payload ูุฒูุฑ ููุดุบู ุงููููุงุก.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ุชูุนูู ุชุญูู HMAC ููุชูููุน ูุจู ุฃู ูุนุงูุฌุฉ.
- ุฑูุถ ุงูุทูุจ `401` ุนูุฏ ุบูุงุจ/ูุดู ุงูุชูููุน.
- ุชุฎุฒูู ุงูุณุฑ ูู **Key Management Layer** (GitHub Secrets/Render Secret Manager)ุ ูููุณ ูู ุงูููุฏ.

---

## 5) ุชุนุงุฑุถ ุจูููู ุจูู ุงูุทุจูุงุช (API/Services)

### ุงููุดููุฉ
ููุทู orchestration ูุงูุชูุงูู ุงูุฎุงุฑุฌู ุธุงูุฑ ุฏุงุฎู route handlers ูุจุงุดุฑุฉ.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ุฅุจูุงุก ุทุจูุงุช ูุงุถุญุฉ:
  - `routes/controllers`: parsing + response codes ููุท
  - `services`: business logic + integrations
  - `repos/gateways`: clients ูู GitHub/Render/Nexus

ูุฐุง ูุญุณู ุงูุงุฎุชุจุงุฑูุฉ ููุงุจููุฉ ุงูุชูุณุน ุจุฏูู ูุณุฑ ุงูุชูุงูู.

---

## 6) ุฎุทุฃ ูุญุชูู ูู Express body parsing

### ุงููุดููุฉ
ุงุณุชุฎุฏุงู `req.body` ูู `POST` endpoints ุจุฏูู ุชุฃููุฏ ูุฌูุฏ `app.use(express.json())` ูู ุงูุชุทุจูู ุงูููุชุฑุญ.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ุฅุถุงูุฉ parsing ูุญุฏูุฏ payload:
```js
app.use(express.json({ limit: '1mb' }));
```

---

## 7) ุฎูู JavaScript ูู server startup

### ุงููุดููุฉ
ุณุทุฑ ุงูุชุดุบูู ููุชุจ ุจุตูุบุฉ ุบูุฑ ุตุญูุญุฉ:
```js
console.log(๐ Server running on port ${PORT});
```
ููุชุฑุถ template string ูุน backticks.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
```js
console.log(`๐ Server running on port ${PORT}`);
```

---

## 8) ุฅุฏุงุฑุฉ ุงูุฃุณุฑุงุฑ: ููุงุญุธุฉ ุฅูุฒุงููุฉ

### ููุงุญุธุฉ ุฃูููุฉ
ูุง ูุฌุจ ุฃุจุฏุงู ูุถุน ุงูููุงุชูุญ ุฏุงุฎู ุงูููุฏ ุฃู ูููุงุช ุซุงุจุชุฉ.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ุงูุงุนุชูุงุฏ ุนูู **Key Management Layer** ุฎุงุฑุฌู ููุท:
  - GitHub Secrets
  - Render Secret Environment
  - Rotation ุฏูุฑู + ุฃูู ุตูุงุญูุฉ (Least Privilege)

---

## 9) ููุงุญุธุฉ ุฎุงุตุฉ ุจุงูุชูุณุน

### ุงููุดููุฉ
ุชุดุบูู `Promise.all` ูุจุงุดุฑุฉ ุฏุงุฎู webhook ุฌูุฏ ูุจุฏุงูุฉุ ูููู ูุฑุจุท ุฒูู ุงุณุชุฌุงุจุฉ GitHub ุจุฒูู ูุฒูุฏุงุช ุงูุฐูุงุก.

### ุงูุฅุฌุฑุงุก ุงููุงุจู ููุชูููุฐ
- ุงุนุชูุงุฏ ููุท async processing:
  1. webhook ูุณุชูุจู ููุฎุฒู job ุจุณุฑุนุฉ
  2. worker ูุนุงูุฌ ูุงุญูุงู
  3. callback/notification ูููุชูุฌุฉ

ููุณ ุงูุณููู ุงููุธูููุ ููุงุจููุฉ ุชูุณุน ุฃุนูู.

---

## ุฃููููุงุช ุงูุชูููุฐ (ุจุฏูู ูุณุฑ ุงูุชูุงูู)
1. ุชุญูู ุชูููุน GitHub webhook.
2. ุฅุฒุงูุฉ ุชูุฑุงุฑ ุชุนุฑูู ุงููููุงุก ูุงุนุชูุงุฏ ูุตุฏุฑ ูุงุญุฏ.
3. ุฌุนู ุงุฎุชุจุงุฑุงุช CI deterministic.
4. ููู ุงูููุทู ูู controllers ุฅูู services/gateways.
5. ุชุญุณูู notify payload ุนุจุฑ `jq`.
