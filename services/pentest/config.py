"""
Configuration settings for BSU Penetration Testing Service
"""

import os
from typing import Optional
from dotenv import load_dotenv

load_dotenv()


class Settings:
    """Application settings"""
    
    # Service settings
    PORT: int = int(os.getenv("PORT", "8001"))
    LOG_LEVEL: str = os.getenv("LOG_LEVEL", "INFO")
    NODE_ENV: str = os.getenv("NODE_ENV", "production")
    
    # MongoDB settings
    MONGODB_URI: str = os.getenv(
        "MONGODB_URI",
        "mongodb://localhost:27017/bsu_pentest"
    )
    
    # OWASP ZAP settings
    ZAP_PROXY: str = os.getenv("ZAP_PROXY", "http://localhost:8080")
    ZAP_API_KEY: str = os.getenv("ZAP_API_KEY", "bsu-secure-key")
    
    # Notification settings
    SLACK_WEBHOOK_URL: Optional[str] = os.getenv("SLACK_WEBHOOK_URL")
    
    # Email settings
    EMAIL_SMTP_HOST: Optional[str] = os.getenv("EMAIL_SMTP_HOST")
    EMAIL_SMTP_PORT: int = int(os.getenv("EMAIL_SMTP_PORT", "587"))
    EMAIL_USERNAME: Optional[str] = os.getenv("EMAIL_USERNAME")
    EMAIL_PASSWORD: Optional[str] = os.getenv("EMAIL_PASSWORD")
    EMAIL_FROM: Optional[str] = os.getenv("EMAIL_FROM")
    EMAIL_TO: Optional[str] = os.getenv("EMAIL_TO")
    
    # Scan settings
    MAX_CONCURRENT_SCANS: int = int(os.getenv("MAX_CONCURRENT_SCANS", "5"))
    SCAN_TIMEOUT_SECONDS: int = int(os.getenv("SCAN_TIMEOUT_SECONDS", "3600"))
    
    # Report settings
    REPORTS_DIR: str = os.getenv("REPORTS_DIR", "/app/reports")
    
    # Security settings
    API_KEY_HEADER: str = "X-API-Key"
    REQUIRE_API_KEY: bool = os.getenv("REQUIRE_API_KEY", "false").lower() == "true"


settings = Settings()
