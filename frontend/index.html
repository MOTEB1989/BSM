<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>BSU/LexBANK - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯</title>
  <meta name="description" content="ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© Ù…Ù† Ù…Ù†ØµØ© BSU/LexBANK - Ø¯Ø¹Ù… Ù…ØªØ¹Ø¯Ø¯ Ù„Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ø°ÙƒÙŠÙŠÙ†" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš–ï¸</text></svg>" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#4c6ef5" />

  <!-- iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="BSU/LexBANK" />
  <meta name="format-detection" content="telephone=no" />

  <!-- Load shared configuration -->
  <script src="../shared/config.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');

    body {
      font-family: 'Tajawal', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    .agent-btn {
      transition: all 0.3s ease;
    }

    .agent-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px -5px rgba(76, 110, 245, 0.4);
    }

    .message-bubble {
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>
<body class="dark bg-gray-950 text-white min-h-screen flex flex-col">

  <div id="app" class="flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-gray-900/80 backdrop-blur-md border-b border-gray-800 sticky top-0 z-50">
      <div class="max-w-6xl mx-auto px-4 py-3">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center text-lg font-bold shadow-lg">
              B
            </div>
            <div>
              <h1 class="text-lg font-bold">BSU/LexBANK</h1>
              <p class="text-xs text-gray-400">{{ lang === 'ar' ? 'Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯' : 'Unified AI Assistant' }}</p>
            </div>
          </div>

          <div class="flex items-center gap-2">
            <!-- Language Toggle -->
            <button @click="toggleLang" class="px-3 py-1.5 text-xs bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors border border-gray-700">
              {{ lang === 'ar' ? 'EN' : 'Ø¹Ø±Ø¨ÙŠ' }}
            </button>

            <!-- GitHub Link -->
            <a :href="config.urls.repo" target="_blank" class="px-3 py-1.5 text-xs bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors border border-gray-700">
              GitHub
            </a>
          </div>
        </div>
      </div>
    </header>

    <!-- Agent Selection -->
    <div v-if="!selectedAgent" class="flex-1 flex items-center justify-center p-4">
      <div class="max-w-4xl w-full">
        <div class="text-center mb-8">
          <h2 class="text-3xl font-bold mb-3">{{ lang === 'ar' ? 'Ø§Ø®ØªØ± Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ' : 'Choose AI Agent' }}</h2>
          <p class="text-gray-400">{{ lang === 'ar' ? 'Ø§Ø®ØªØ± Ù…Ù† Ø¨ÙŠÙ† 5 ÙˆÙƒÙ„Ø§Ø¡ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªÙ‚Ø¯Ù…ÙŠÙ†' : 'Choose from 5 advanced AI agents' }}</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <!-- GPT Agent -->
          <button @click="selectAgent('gpt')" class="agent-btn p-6 bg-gray-900 hover:bg-gray-800 rounded-xl border-2 border-gray-800 hover:border-blue-600 text-right">
            <div class="text-2xl mb-2">ğŸ¤–</div>
            <h3 class="text-lg font-bold mb-2">GPT-4</h3>
            <p class="text-sm text-gray-400 mb-3">{{ lang === 'ar' ? 'Ù†Ù…ÙˆØ°Ø¬ OpenAI Ø§Ù„Ù…ØªÙ‚Ø¯Ù…' : 'OpenAI Advanced Model' }}</p>
            <span class="inline-block px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded">{{ lang === 'ar' ? 'Ù†Ø´Ø·' : 'Active' }}</span>
          </button>

          <!-- Gemini Agent -->
          <button @click="selectAgent('gemini')" class="agent-btn p-6 bg-gray-900 hover:bg-gray-800 rounded-xl border-2 border-gray-800 hover:border-blue-600 text-right">
            <div class="text-2xl mb-2">âœ¨</div>
            <h3 class="text-lg font-bold mb-2">Gemini</h3>
            <p class="text-sm text-gray-400 mb-3">{{ lang === 'ar' ? 'Ù†Ù…ÙˆØ°Ø¬ Google Ø§Ù„Ù…ØªØ·ÙˆØ±' : 'Google Advanced Model' }}</p>
            <span class="inline-block px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded">{{ lang === 'ar' ? 'Ù†Ø´Ø·' : 'Active' }}</span>
          </button>

          <!-- Claude Agent -->
          <button @click="selectAgent('claude')" class="agent-btn p-6 bg-gray-900 hover:bg-gray-800 rounded-xl border-2 border-gray-800 hover:border-blue-600 text-right">
            <div class="text-2xl mb-2">ğŸ­</div>
            <h3 class="text-lg font-bold mb-2">Claude</h3>
            <p class="text-sm text-gray-400 mb-3">{{ lang === 'ar' ? 'Ù†Ù…ÙˆØ°Ø¬ Anthropic Ø§Ù„Ø°ÙƒÙŠ' : 'Anthropic Smart Model' }}</p>
            <span class="inline-block px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded">{{ lang === 'ar' ? 'Ù†Ø´Ø·' : 'Active' }}</span>
          </button>

          <!-- Perplexity Agent -->
          <button @click="selectAgent('perplexity')" class="agent-btn p-6 bg-gray-900 hover:bg-gray-800 rounded-xl border-2 border-gray-800 hover:border-blue-600 text-right">
            <div class="text-2xl mb-2">ğŸ”</div>
            <h3 class="text-lg font-bold mb-2">Perplexity</h3>
            <p class="text-sm text-gray-400 mb-3">{{ lang === 'ar' ? 'Ø¨Ø­Ø« Ø°ÙƒÙŠ Ù…Ø¹ Ù…ØµØ§Ø¯Ø±' : 'Smart Search with Citations' }}</p>
            <span class="inline-block px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded">{{ lang === 'ar' ? 'Ù†Ø´Ø·' : 'Active' }}</span>
          </button>

          <!-- Kimi Agent -->
          <button @click="selectAgent('kimi')" class="agent-btn p-6 bg-gray-900 hover:bg-gray-800 rounded-xl border-2 border-gray-800 hover:border-blue-600 text-right">
            <div class="text-2xl mb-2">ğŸŒ™</div>
            <h3 class="text-lg font-bold mb-2">Kimi</h3>
            <p class="text-sm text-gray-400 mb-3">{{ lang === 'ar' ? 'Ù†Ù…ÙˆØ°Ø¬ Moonshot Ø§Ù„Ù…ØªÙ‚Ø¯Ù…' : 'Moonshot Advanced Model' }}</p>
            <span class="inline-block px-2 py-1 text-xs bg-green-500/20 text-green-400 rounded">{{ lang === 'ar' ? 'Ù†Ø´Ø·' : 'Active' }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Chat Interface -->
    <div v-else class="flex-1 flex flex-col max-w-4xl mx-auto w-full">
      <!-- Agent Header -->
      <div class="bg-gray-900 border-b border-gray-800 p-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <button @click="selectedAgent = null" class="text-gray-400 hover:text-white transition-colors">
              â† {{ lang === 'ar' ? 'Ø±Ø¬ÙˆØ¹' : 'Back' }}
            </button>
            <div>
              <h3 class="font-bold">{{ getAgentName(selectedAgent) }}</h3>
              <p class="text-xs text-gray-400">{{ getAgentProvider(selectedAgent) }}</p>
            </div>
          </div>
          <button @click="clearChat" class="text-xs text-gray-400 hover:text-white transition-colors">
            {{ lang === 'ar' ? 'Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©' : 'Clear Chat' }}
          </button>
        </div>
      </div>

      <!-- Messages -->
      <div class="flex-1 overflow-y-auto p-4 space-y-4" ref="messagesContainer">
        <div v-for="(msg, idx) in messages" :key="idx" class="message-bubble" :class="msg.role === 'user' ? 'text-right' : 'text-left'">
          <div :class="msg.role === 'user' ? 'bg-blue-600 text-white inline-block rounded-2xl px-4 py-3 max-w-[80%]' : 'bg-gray-800 text-white inline-block rounded-2xl px-4 py-3 max-w-[80%]'">
            <div v-html="formatMessage(msg.content)"></div>
          </div>
        </div>

        <div v-if="loading" class="text-left">
          <div class="bg-gray-800 inline-block rounded-2xl px-4 py-3">
            <div class="flex gap-2">
              <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
              <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
              <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
            </div>
          </div>
        </div>

        <div v-if="error" class="text-center">
          <div class="bg-red-900/30 border border-red-800 text-red-400 inline-block rounded-xl px-4 py-3">
            {{ error }}
          </div>
        </div>
      </div>

      <!-- Input -->
      <div class="border-t border-gray-800 p-4">
        <form @submit.prevent="sendMessage" class="flex gap-2">
          <input
            v-model="input"
            type="text"
            :placeholder="lang === 'ar' ? 'Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...' : 'Type your message here...'"
            class="flex-1 bg-gray-900 text-white px-4 py-3 rounded-xl border border-gray-800 focus:border-blue-600 focus:outline-none"
            :disabled="loading"
          />
          <button
            type="submit"
            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
            :disabled="loading || !input.trim()"
          >
            {{ lang === 'ar' ? 'Ø¥Ø±Ø³Ø§Ù„' : 'Send' }}
          </button>
        </form>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-800 py-4 text-center text-sm text-gray-400">
      <p>
        {{ lang === 'ar' ? 'Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ù€' : 'Powered by' }}
        <a :href="config.urls.backend" target="_blank" class="text-blue-400 hover:text-blue-300">BSU/LexBANK</a>
        |
        <a :href="config.urls.repo" target="_blank" class="text-blue-400 hover:text-blue-300">GitHub</a>
      </p>
    </footer>

  </div>

  <script src="app.js"></script>
</body>
</html>
