# سياسة نشر التوثيق (Documentation Deployment Policy)

> وثيقة رسمية توضّح مصدر بناء التوثيق، طريقة النشر عبر CI/CD، وسياسة إصدار نسخ التوثيق.

## 1) مصدر البناء (Source of Truth)

مصدر التوثيق الرسمي في هذا المستودع هو:

- مجلد `docs/` لجميع ملفات Markdown (`*.md`) والملفات الثابتة الخاصة بواجهة GitHub Pages.
- الملف `docs/README.md` كفهرس رئيسي لوثائق المشروع.
- الملف `README.md` في الجذر كمدخل عام يربط إلى الوثائق التفصيلية.

## 2) أداة التوليد وخطوات Build/Deploy

### أداة التوليد

لا توجد أداة توليد إلزامية (مثل MkDocs/Docusaurus) في الوضع الحالي.

- إذا وُجد `docs/package.json` ويحتوي `scripts.build`، يتم تشغيل build مخصص داخل CI.
- إذا لم يوجد build مخصص، يتم نشر مجلد `docs/` مباشرة كـ static content.

### خط سير CI/CD الحالي

#### A) التحقق (Validation)

- Workflow: `.github/workflows/validate.yml`
- الهدف: التحقق من سلامة المشروع عبر:
  - `npm ci`
  - `npm run validate`

#### B) نشر التوثيق على GitHub Pages

يوجد مساران محتملان للنشر بحسب الـ workflow المستخدم:

1. **`deploy-pages.yml`**
   - ينشئ `docs/config.js` من المتغير السري `API_BASE_URL` (مع fallback آمن).
   - إذا كان هناك build script داخل `docs/package.json` يتم تشغيله.
   - ينشر ناتج build (أو مجلد `docs/`) باستخدام `peaceiris/actions-gh-pages`.

2. **`static.yml`**
   - يرفع محتوى ثابت إلى GitHub Pages باستخدام `actions/upload-pages-artifact` ثم `actions/deploy-pages`.

> ملاحظة تشغيلية: للحفاظ على سلوك متوقع، يُفضَّل اعتماد workflow واحد كمسار نشر أساسي للتوثيق وتحديد الآخر كبديل/احتياطي.

### خطوات تشغيل محلية (اختيارية)

في حال إضافة مولّد توثيق مستقبلاً داخل `docs/`:

```bash
cd docs
pnpm install
pnpm run build
```

أما حالياً، فالمحتوى Markdown/static في `docs/` جاهز للنشر بدون build إلزامي.

## 3) سياسة Versioning للتوثيق

تعتمد المنصة سياسة هجينة بسيطة وقابلة للتتبّع:

### A) نسخ مرتبطة بالإصدارات (Release-aligned)

- مع كل إصدار منتج (Git tag/release)، يجب تحديث/مراجعة الوثائق ذات الصلة.
- التعديلات الجوهرية في التوثيق تُسجّل ضمن ملاحظات الإصدار (Release Notes).

### B) وسوم Git مخصصة للتوثيق (اختياري لكن موصى به)

- يمكن استخدام وسوم مستقلة للتوثيق بصيغة:
  - `docs-vMAJOR.MINOR.PATCH`
  - مثال: `docs-v1.2.0`
- تستخدم عندما تكون تغييرات التوثيق واسعة أو غير مرتبطة مباشرة بكود التطبيق.

### C) تنظيم إصدارات المحتوى

- في حال الحاجة لعرض نسخ متزامنة متعددة، يُستخدم هيكل مجلدات داخل `docs/versions/` مثل:
  - `docs/versions/v1/`
  - `docs/versions/v2/`
- النسخة الحالية تبقى في جذر `docs/`، والنسخ المؤرشفة تنقل إلى `docs/versions/`.

## 4) ضوابط الحوكمة والجودة

- أي تعديل على وثائق التشغيل/الأمان/النشر يجب أن يمر عبر Pull Request.
- يجب تجنب إدراج أسرار أو مفاتيح API في ملفات Markdown.
- الروابط المرجعية في `docs/README.md` و`README.md` يجب تحديثها عند إضافة وثائق رسمية جديدة.

## 5) سجل التغيير لهذه الوثيقة

- `v1.0.0` — إنشاء الوثيقة واعتماد السياسة الأولية للبناء، النشر، والنسخ.

